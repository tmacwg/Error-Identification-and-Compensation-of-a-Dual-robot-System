function [ xnum,yita ] = numsolution( RA,RB,RC,ta,tb,tc,RX,RY,RZ,tx,ty,tz,m,miu,o,miu2,miu3,f )
%UNTITLED5 Summary of this function goes here
%   Detailed explanation goes here
[a,b]=size(RA);
n=b/3;
%m=3;%梯度的更新频率
%o=300;%迭代循环次数
%miu=0.1;
g=zeros(3,12*o);
yita=zeros(o,1);
yita(1)=0.1;
ggt=zeros(3,12*n);
x(:,1:12)=[RX,RY,RZ,tx,ty,tz];
%x(:,1:12)=[RX+orth(rand(3,3))/3,RY+orth(rand(3,3))/3,RZ+orth(rand(3,3))/3,tx+2*rand(3,1),ty+2*rand(3,1),tz+2*rand(3,1)];
%miu2= 3/(norm(tx)^2+norm(ty)^2+norm(tz)^2);
%miu3= 3/(norm(tx)+norm(ty)+norm(tz));
if o>=1
    for k=1:o
        for i=1:n
            
            ggk(:,(12*i-11):12*i)=2*[f*(x(:,(12*k-11):(12*k-9))*RB(:,(3*i-2):3*i)*RB(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k-5):(12*k-3))*RB(:,(3*i-2):3*i)'+...
                miu2*(x(:,(12*k-11):(12*k-9))*tb((3*i-2):3*i)*tb((3*i-2):3*i)'+x(:,(12*k-2))*tb((3*i-2):3*i)'+RA(:,(3*i-2):3*i)'*ta((3*i-2):3*i)*tb((3*i-2):3*i)'-...
                RA(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k))*tb((3*i-2):3*i)'- RA(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))*tc((3*i-2):3*i)*tb((3*i-2):3*i)'-...
                RA(:,(3*i-2):3*i)'*x(:,(12*k-1))*tb((3*i-2):3*i)')+2*miu*(x(:,(12*k-11):(12*k-9))*x(:,(12*k-11):(12*k-9))'*x(:,(12*k-11):(12*k-9))-x(:,(12*k-11):(12*k-9)))),...
                f*(x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k-5):(12*k-3))*x(:,(12*k-5):(12*k-3))'*RC(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)*x(:,(12*k-11):(12*k-9))*RB(:,(3*i-2):3*i)*x(:,(12*k-5):(12*k-3))'*RC(:,(3*i-2):3*i)'+...
                miu2*(x(:,(12*k-8):(12*k-6))*tc((3*i-2):3*i)*tc((3*i-2):3*i)'+...
                x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k))*x(:,(12*k))'*RC(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)*x(:,(12*k-11):(12*k-9))*tb((3*i-2):3*i)*x(:,(12*k))'*RC(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)*x(:,(12*k-11):(12*k-9))*tb((3*i-2):3*i)*tc((3*i-2):3*i)'-...
                RA(:,(3*i-2):3*i)*x(:,(12*k-2))*x(:,(12*k))'*RC(:,(3*i-2):3*i)'- RA(:,(3*i-2):3*i)*x(:,(12*k-2))*tc((3*i-2):3*i)'-ta((3*i-2):3*i)*x(:,(12*k))'*RC(:,(3*i-2):3*i)'-ta((3*i-2):3*i)*tc((3*i-2):3*i)'+...
                x(:,(12*k-8):(12*k-6))*tc((3*i-2):3*i)*x(:,(12*k))'*RC(:,(3*i-2):3*i)'+x(:,(12*k-1))*x(:,(12*k))'*RC(:,(3*i-2):3*i)'+x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k))*tc((3*i-2):3*i)'+x(:,(12*k-1))*tc((3*i-2):3*i)')+2*miu*(x(:,(12*k-8):(12*k-6))*x(:,(12*k-8):(12*k-6))'*x(:,(12*k-8):(12*k-6))-x(:,(12*k-8):(12*k-6)))),...
                f*(RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*x(:,(12*k-8):(12*k-6))* RC(:,(3*i-2):3*i)*x(:,(12*k-5):(12*k-3))-RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*RA(:,(3*i-2):3*i)*x(:,(12*k-11):(12*k-9))*RB(:,(3*i-2):3*i)+2*miu*(x(:,(12*k-5):(12*k-3))*x(:,(12*k-5):(12*k-3))'*x(:,(12*k-5):(12*k-3))-x(:,(12*k-5):(12*k-3)))),...
                miu3*(x(:,(12*k-2))+x(:,(12*k-11):(12*k-9))*tb((3*i-2):3*i)+RA(:,(3*i-2):3*i)'*ta((3*i-2):3*i)-RA(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k))-RA(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))*tc((3*i-2):3*i)-RA(:,(3*i-2):3*i)'*x(:,(12*k-1))),...
                miu3*(x(:,(12*k-1))-RA(:,(3*i-2):3*i)*x(:,(12*k-11):(12*k-9))*tb((3*i-2):3*i)-RA(:,(3*i-2):3*i)*x(:,(12*k-2))-ta((3*i-2):3*i)+x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k))+x(:,(12*k-8):(12*k-6))*tc((3*i-2):3*i)),...
                miu3*(RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*x(:,(12*k-8):(12*k-6))*RC(:,(3*i-2):3*i)*x(:,(12*k))-RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*RA(:,(3*i-2):3*i)*x(:,(12*k-11):(12*k-9))*tb((3*i-2):3*i)-RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*RA(:,(3*i-2):3*i)*x(:,(12*k-2))-...
                RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*ta((3*i-2):3*i)+RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*x(:,(12*k-8):(12*k-6))*tc((3*i-2):3*i)+RC(:,(3*i-2):3*i)'*x(:,(12*k-8):(12*k-6))'*x(:,(12*k-1)))];
            
            g(1:3,(12*k-11):12*k)=g(1:3,(12*k-11):12*k)+1/n*ggk(:,(12*i-11):12*i);
        end
        if k>1
            %yita(k)=yita(k-1)/1.1;
            %yita(k)=1/m*(norm(x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)))/norm(g(1:3,(12*k-11):12*k)-g(1:3,(12*(k-1)-11):12*(k-1))));
            %yita(k)=1/m*(norm(x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)))^2/norm((x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)))'*(g(1:3,(12*k-11):12*k)-g(1:3,(12*(k-1)-11):12*(k-1)))));
            yita(k)=1/m*(norm(x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)),'fro')^2/norm((x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)))'*(g(1:3,(12*k-11):12*k)-g(1:3,(12*(k-1)-11):12*(k-1))),'fro'));%f范数形式，精度更高
            %e(k)=norm((x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)))'*(g(1:3,(12*k-11):12*k)-g(1:3,(12*(k-1)-11):12*(k-1))));
            %f(k)=norm(x(:,(12*k-11):12*k)-x(:,(12*(k-1)-11):12*(k-1)));
        end
        xt(:,1:12)=x(:,(12*k-11):12*k);
        
        for t=1:m
            i=unidrnd(n);
            ggt(:,(12*i-11):12*i)=2*[f*(xt(:,(12*t-11):(12*t-9))*RB(:,(3*i-2):3*i)*RB(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t-5):(12*t-3))*RB(:,(3*i-2):3*i)'+...
                miu2*(xt(:,(12*t-11):(12*t-9))*tb((3*i-2):3*i)*tb((3*i-2):3*i)'+xt(:,(12*t-2))*tb((3*i-2):3*i)'+RA(:,(3*i-2):3*i)'*ta((3*i-2):3*i)*tb((3*i-2):3*i)'-...
                RA(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t))*tb((3*i-2):3*i)'- RA(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))*tc((3*i-2):3*i)*tb((3*i-2):3*i)'-...
                RA(:,(3*i-2):3*i)'*xt(:,(12*t-1))*tb((3*i-2):3*i)')+2*miu*(xt(:,(12*t-11):(12*t-9))*xt(:,(12*t-11):(12*t-9))'*xt(:,(12*t-11):(12*t-9))-xt(:,(12*t-11):(12*t-9)))),...
                f*(xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t-5):(12*t-3))*xt(:,(12*t-5):(12*t-3))'*RC(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)*xt(:,(12*t-11):(12*t-9))*RB(:,(3*i-2):3*i)*xt(:,(12*t-5):(12*t-3))'*RC(:,(3*i-2):3*i)'+...
                miu2*(xt(:,(12*t-8):(12*t-6))*tc((3*i-2):3*i)*tc((3*i-2):3*i)'+...
                xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t))*xt(:,(12*t))'*RC(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)*xt(:,(12*t-11):(12*t-9))*tb((3*i-2):3*i)*xt(:,(12*t))'*RC(:,(3*i-2):3*i)'-RA(:,(3*i-2):3*i)*xt(:,(12*t-11):(12*t-9))*tb((3*i-2):3*i)*tc((3*i-2):3*i)'-...
                RA(:,(3*i-2):3*i)*xt(:,(12*t-2))*xt(:,(12*t))'*RC(:,(3*i-2):3*i)'- RA(:,(3*i-2):3*i)*xt(:,(12*t-2))*tc((3*i-2):3*i)'-ta((3*i-2):3*i)*xt(:,(12*t))'*RC(:,(3*i-2):3*i)'-ta((3*i-2):3*i)*tc((3*i-2):3*i)'+...
                xt(:,(12*t-8):(12*t-6))*tc((3*i-2):3*i)*xt(:,(12*t))'*RC(:,(3*i-2):3*i)'+xt(:,(12*t-1))*xt(:,(12*t))'*RC(:,(3*i-2):3*i)'+xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t))*tc((3*i-2):3*i)'+xt(:,(12*t-1))*tc((3*i-2):3*i)')+2*miu*(xt(:,(12*t-8):(12*t-6))*xt(:,(12*t-8):(12*t-6))'*xt(:,(12*t-8):(12*t-6))-xt(:,(12*t-8):(12*t-6)))),...
                f*(RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*xt(:,(12*t-8):(12*t-6))* RC(:,(3*i-2):3*i)*xt(:,(12*t-5):(12*t-3))-RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*RA(:,(3*i-2):3*i)*xt(:,(12*t-11):(12*t-9))*RB(:,(3*i-2):3*i)+2*miu*(xt(:,(12*t-5):(12*t-3))*xt(:,(12*t-5):(12*t-3))'*xt(:,(12*t-5):(12*t-3))-xt(:,(12*t-5):(12*t-3)))),...
                miu3*(xt(:,(12*t-2))+xt(:,(12*t-11):(12*t-9))*tb((3*i-2):3*i)+RA(:,(3*i-2):3*i)'*ta((3*i-2):3*i)-RA(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t))-RA(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))*tc((3*i-2):3*i)-RA(:,(3*i-2):3*i)'*xt(:,(12*t-1))),...
                miu3*(xt(:,(12*t-1))-RA(:,(3*i-2):3*i)*xt(:,(12*t-11):(12*t-9))*tb((3*i-2):3*i)-RA(:,(3*i-2):3*i)*xt(:,(12*t-2))-ta((3*i-2):3*i)+xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t))+xt(:,(12*t-8):(12*t-6))*tc((3*i-2):3*i)),...
                miu3*(RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*xt(:,(12*t-8):(12*t-6))*RC(:,(3*i-2):3*i)*xt(:,(12*t))-RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*RA(:,(3*i-2):3*i)*xt(:,(12*t-11):(12*t-9))*tb((3*i-2):3*i)-RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*RA(:,(3*i-2):3*i)*xt(:,(12*t-2))-...
                RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*ta((3*i-2):3*i)+RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*xt(:,(12*t-8):(12*t-6))*tc((3*i-2):3*i)+RC(:,(3*i-2):3*i)'*xt(:,(12*t-8):(12*t-6))'*xt(:,(12*t-1)))];
            
            xt(:,(12*(t+1)-11):12*(t+1))=xt(:,(12*t-11):12*t)- yita(k)*(ggt(:,(12*i-11):12*i)-ggk(:,(12*i-11):12*i)+g(1:3,(12*k-11):12*k));
            r=ggt(:,(12*i-11):12*i);
            s=ggk(:,(12*i-11):12*i);
            t=g(1:3,(12*k-11):12*k);
            u=(ggt(:,(12*i-11):12*i)-ggk(:,(12*i-11):12*i)+g(1:3,(12*k-11):12*k));
        end
        x(:,(12*(k+1)-11):12*(k+1))= xt(:,(12*(m+1)-11):12*(m+1));
    end
    xnum= x(:,(12*(k+1)-11):12*(k+1));
else
    xnum=x(:,1:12);
end
end

